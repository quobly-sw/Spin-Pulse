
spin_pulse.environment.noise
============================

.. py:module:: spin_pulse.environment.noise

.. autoapi-nested-parse::

   This modules provides a set of noise classes for simulating different noise processes:
       - QUASISTATIC: Quasistatic noise generated by `QuasistaticNoiseTimeTrace` from :mod:`spin_pulse.environment.noise.quasistatic`.
       - PINK: Pink (1/f) noise generated by `PinkNoiseTimeTrace` from :mod:`spin_pulse.environment.noise.pink`.
       - WHITE: White Gaussian noise generated by `WhiteNoiseTimeTrace` from :mod:`spin_pulse.environment.noise.white`.




Re-exported objects
-------------------

The following objects can be directly imported from spin_pulse.environment.noise even if they
are implemented in submodules.

.. list-table::
   :widths: 30 70

   * - :py:class:`~spin_pulse.environment.noise.noise_time_trace.NoiseTimeTrace`
     - Base class for generating and manipulating noise time traces.
   * - :py:class:`~spin_pulse.environment.noise.noise_time_trace.NoiseType`
     - Enumerate the supported noise models for spin-qubit simulations.
   * - :py:class:`~spin_pulse.environment.noise.pink.PinkNoiseTimeTrace`
     - Generate a pink noise time trace with a 1/f power spectral density.
   * - :py:class:`~spin_pulse.environment.noise.quasistatic.QuasistaticNoiseTimeTrace`
     - Generate a quasi-static noise time trace for spin-qubit simulations.
   * - :py:class:`~spin_pulse.environment.noise.white.WhiteNoiseTimeTrace`
     - Generate a white noise time trace.


Submodules
----------

.. toctree::
   :maxdepth: 1

   /autoapi/spin_pulse/environment/noise/noise_time_trace/index
   /autoapi/spin_pulse/environment/noise/pink/index
   /autoapi/spin_pulse/environment/noise/quasistatic/index
   /autoapi/spin_pulse/environment/noise/white/index


Classes
-------

.. autoapisummary::

   spin_pulse.environment.noise.NoiseTimeTrace
   spin_pulse.environment.noise.NoiseType
   spin_pulse.environment.noise.PinkNoiseTimeTrace
   spin_pulse.environment.noise.QuasistaticNoiseTimeTrace
   spin_pulse.environment.noise.WhiteNoiseTimeTrace


Package Contents
----------------


.. py:class:: NoiseTimeTrace(duration)

   Base class for generating and manipulating noise time traces.

   A noise time trace is represented as an array of length ``duration``,
   containing the instantaneous noise values :math:`\epsilon(t)` that affect the qubit.
   Subclasses implement specific noise models (quasistatic, pink, white, etc.)
   and populate the ``values`` array accordingly.

   .. attribute:: - duration

      Total number of time steps in the noise trace.

      :type: int

   .. attribute:: - values

      Array of noise values of length ``duration``.

      :type: ndarray

   Initializes an empty noise time trace of given duration.

   :param duration: Total number of time steps in the noise trace.
   :type duration: int


   .. py:attribute:: duration


   .. py:attribute:: values


   .. py:method:: ramsey_contrast(ramsey_duration)

      Compute the Ramsey contrast for a qubit subject to this noise trace.

      The qubit is initialized in the equal superposition state :math:`\frac{\\lvert 0 \rangle + \\lvert 1 \rangle}{\\sqrt{2}}`
      and evolves under a pure dephasing Hamiltonian :math:`H(t) = \\omega(t) Z`.
      The Ramsey contrast is obtained from the accumulated phase :math:`\\sum_t \\omega(t)`
      over segments of length ``ramsey_duration``. The trace is divided into independent
      experiments of equal length and the contrast is averaged over all experiments.

      :param ramsey_duration: Number of time steps per Ramsey experiment.
      :type ramsey_duration: int

      :returns: Averaged Ramsey contrast of length ``ramsey_duration``.
      :rtype: - float



   .. py:method:: plot_ramsey_contrast(ramsey_duration)

      Plot the Ramsey contrast computed from the noise trace.

      :param ramsey_duration: Number of time steps per Ramsey experiment.
      :type ramsey_duration: int



   .. py:method:: plot(n_max = None)

      Plot the noise trace up to a specified number of points.

      :param n_max: Number of time steps to display. If None,
                    the full trace is shown.
      :type n_max: int | None



.. py:class:: NoiseType(*args, **kwds)

   Bases: :py:obj:`enum.Enum`


   Enumerate the supported noise models for spin-qubit simulations.

   Each enum value corresponds to the time-trace class used to generate
   the associated noise realization.

   Noise types:
       - QUASISTATIC: Quasistatic noise generated by
           `QuasistaticNoiseTimeTrace`.
       - PINK: Pink (1/f) noise generated by `PinkNoiseTimeTrace`.
       - WHITE: White Gaussian noise generated by `WhiteNoiseTimeTrace`.



   .. py:attribute:: QUASISTATIC
      :value: 'QuasistaticNoiseTimeTrace'



   .. py:attribute:: PINK
      :value: 'PinkNoiseTimeTrace'



   .. py:attribute:: WHITE
      :value: 'WhiteNoiseTimeTrace'



.. py:class:: PinkNoiseTimeTrace(T2S, duration, segment_duration, seed = None)

   Bases: :py:obj:`spin_pulse.environment.noise.noise_time_trace.NoiseTimeTrace`


   Generate a pink noise time trace with a 1/f power spectral density.

   This class constructs a noise trace of length ``duration`` where the
   spectral density follows a pink noise distribution proportional to
   ``1/f``. A low-frequency cutoff is enforced at ``1/segment_duration`` by
   building the trace from repeated pink noise segments. The parameter ``T2S``
   determines the noise intensity through the scaling factor ``S0`` defined as::

       S0 = 1 / (4 * pi^2 * log(segment_duration) * T2S^2)

   The internal array ``values`` contains the generated noise samples and
   is used by methods such as ``ramsey_contrast`` to evaluate the effect of
   pink noise on qubit coherence.

   .. attribute:: - segment_duration

      Length of each pink noise segment.

      :type: int

   .. attribute:: - S0

      Scaling factor controlling the noise intensity.

      :type: float

   .. attribute:: - T2S

      Coherence time parameter determining the noise intensity.

      :type: float

   .. attribute:: - sigma

      Standard deviation of the generated noise values.

      :type: float

   .. attribute:: - values

      Noise values of length ``duration``.

      :type: ndarray

   Create a pink noise time trace for spin qubit simulations.

   The generated noise satisfies a spectral density proportional to
   ``1/(f*ts)`` with a low frequency cutoff ``f_min=1/segment_duration``.
   The parameter ``T2S`` sets the noise intensity through the relation
   ``S0 = 1 / (4 * pi^2 * log(segment_duration) * T2S^2)``. The internal
   noise trace has length ``duration`` and is constructed by repeating
   pink noise segments.

   :param T2S: Coherence time parameter determining the noise
               intensity.
   :type T2S: float
   :param duration: Total number of time steps in the noise trace.
   :type duration: int
   :param segment_duration: Length of each pink noise segment.
   :type segment_duration: int
   :param seed: Optional seed for reproducible random
                number generation.
   :type seed: int | None

   :returns: The time trace is stored internally in ``self.values``.
   :rtype: None


   .. py:attribute:: segment_duration


   .. py:attribute:: values


   .. py:attribute:: S0


   .. py:attribute:: T2S


   .. py:attribute:: sigma


   .. py:method:: plot_ramsey_contrast(ramsey_duration)

      Plot analytical and numerical Ramsey contrast curves.

      This method overlays:
          - the analytical Gaussian contrast expected for pink noise,
          - a corrected analytical contrast that accounts for the
            frequency cutoff imposed by ``segment_duration``,
          - the numerical contrast obtained from the underlying noise trace.

      :param ramsey_duration: Number of time steps used in the
                              Ramsey experiment evaluation.
      :type ramsey_duration: int

      :returns: The function produces a plot of the Ramsey contrast.
      :rtype: None



.. py:class:: QuasistaticNoiseTimeTrace(T2S, duration, segment_duration, seed = None)

   Bases: :py:obj:`spin_pulse.environment.noise.noise_time_trace.NoiseTimeTrace`


   Generate a quasi-static noise time trace for spin-qubit simulations.

   This noise type produces a sequence of piecewise-constant Gaussian
   noise segments. Each segment has duration ``segment_duration``, and all
   samples within a segment share the same random value. The resulting
   noise corresponds to a quasi-static fluctuation with standard deviation
   determined by the coherence time ``T2S``.

   .. attribute:: - segment_duration

      Duration of each constant-noise segment.

      :type: int

   .. attribute:: - sigma

      Standard deviation of the quasistatic noise,
      computed as :math:`\sqrt{2}/T_2^*`.

      :type: float

   .. attribute:: - T2S

      Coherence time parameter used to scale the noise.

      :type: float

   .. attribute:: - values

      Array of noise values of length ``duration``.

      :type: ndarray

   Initialize a quasi-static Gaussian noise trace.

   The noise trace is constructed from repeated Gaussian segments of
   length ``segment_duration``. Each segment takes a single Gaussian
   random value with zero mean and standard deviation :math:`\sqrt{2}/T_2^*`.
   The total duration must be an integer multiple of the segment length.

   :param T2S: Coherence time parameter defining the noise intensity.
   :type T2S: float
   :param duration: Total number of time steps in the noise trace.
   :type duration: int
   :param segment_duration: Length of each piecewise-constant segment.
   :type segment_duration: int
   :param seed: Optional seed for reproducible random generation.
   :type seed: int | None

   :raises ValueError: If ``duration`` is not divisible by ``segment_duration``.


   .. py:attribute:: segment_duration


   .. py:attribute:: sigma


   .. py:attribute:: T2S


   .. py:attribute:: values


   .. py:method:: plot_ramsey_contrast(ramsey_duration)

      Plot the analytical and simulated Ramsey contrast.

      The analytical contrast :math:`\exp(-t^2 / T_2^{*2})` is plotted together
      with the contrast returned by the parent ``NoiseTimeTrace`` class.

      :param ramsey_duration: Duration over which the Ramsey signal
                              is evaluated.
      :type ramsey_duration: int



.. py:class:: WhiteNoiseTimeTrace(T2S, duration, segment_duration, seed = None)

   Bases: :py:obj:`spin_pulse.environment.noise.noise_time_trace.NoiseTimeTrace`


   Generate a white noise time trace.

   This class constructs a noise trace of length ``duration`` where each
   time step is drawn from an independent Gaussian distribution. The noise
   intensity is determined by the coherence time ``T2S`` that fixes the standard
   deviation :math:`\sqrt{2/T_2^*}`. White noise corresponds to a flat
   power spectral density and requires ``segment_duration = 1``.

   .. attribute:: - segment_duration

      Always equal to 1 for white noise.

      :type: int

   .. attribute:: - sigma

      Standard deviation controlling the noise intensity.

      :type: float

   .. attribute:: - T2S

      Coherence time parameter determining the noise intensity.

      :type: float

   .. attribute:: - values

      Noise samples of length ``duration``.

      :type: ndarray

   Initialize a white noise time trace for spin qubit simulations.

   Each value of the trace is drawn independently from a Gaussian
   distribution with zero mean and standard deviation :math:`\sqrt{2/T_2^*}`.
   The ``segment_duration`` parameter must be equal to 1, since white
   noise has no temporal correlations.

   :param T2S: Coherence time parameter determining the noise intensity.
   :type T2S: float
   :param duration: Total number of time steps in the noise trace.
   :type duration: int
   :param segment_duration: Must be equal to 1 for white noise.
   :type segment_duration: int
   :param seed: Optional seed for reproducible random
                number generation.
   :type seed: int | None

   :returns: The generated noise values are stored in ``self.values``.
   :rtype: None


   .. py:attribute:: segment_duration
      :value: 1



   .. py:attribute:: sigma


   .. py:attribute:: values


   .. py:attribute:: T2S


   .. py:method:: plot_ramsey_contrast(ramsey_duration)

      Plot analytical and numerical Ramsey contrast for white noise.

      The plot overlays:

      - the analytical exponential decay expected for white noise,
      - the numerical contrast computed from the generated time trace.

      :param ramsey_duration: Number of time steps used in the
                              Ramsey experiment evaluation.
      :type ramsey_duration: int

      :returns: The function produces a plot of the Ramsey contrast.
      :rtype: None
